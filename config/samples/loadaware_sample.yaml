apiVersion: advisor.kubevirt.io/v1alpha1
kind: VirtPlatformConfig
metadata:
  labels:
    app.kubernetes.io/name: virt-advisor-operator
    app.kubernetes.io/managed-by: kustomize
  # Name must match spec.profile (singleton pattern enforced by CEL validation)
  name: load-aware-rebalancing
spec:
  # Profile name determines which configuration template to apply
  # This profile enables load-aware scheduling by configuring:
  # 1. KubeDescheduler to use LoadAware profile
  # 2. MachineConfig to enable PSI (Pressure Stall Information) metrics
  profile: load-aware-rebalancing

  # Action controls the workflow:
  # - "DryRun": Calculate changes and show diff without applying (start here!)
  # - "Apply": Execute the planned changes (change to this after reviewing the diff)
  action: DryRun

  # FailurePolicy controls behavior when a step fails:
  # - "Abort": Stop on first failure
  # - "Continue": Attempt remaining steps even if one fails
  failurePolicy: Abort

  # Options allows type-safe fine-tuning of profile parameters
  # This field is optional - if omitted, profile defaults will be used
  # options:
  #   loadAware:
  #     deschedulingIntervalSeconds: 1800  # Integer (60-86400), default: 1800
  #     enablePSIMetrics: true              # Boolean, default: true
  #     devDeviationThresholds: AsymmetricLow  # Enum: Low|AsymmetricLow|High
